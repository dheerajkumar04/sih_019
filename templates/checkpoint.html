<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Lesson 1: What is a Computer?</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow-x: hidden;
      font-family: sans-serif;
      position: relative;
      color: #333;
      background: url('../static/cpbg.webp') no-repeat center center fixed;
      background-size: cover;
    }

    @keyframes slideDownFadeOut {
      0% {
        opacity: 1;
        transform: translateY(0);
      }
      100% {
        opacity: 0;
        transform: translateY(150px);
      }
    }

    @keyframes slideUpFadeIn {
      0% {
        opacity: 0;
        transform: translateY(150px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .lesson-heading {
      position: fixed;
      top: 4%;
      right: 2%;
      width: 50vw;
      max-width: 600px;
      padding: 20px 30px;
      background: rgba(0, 0, 0, 0.6);
      color: #fff8e1;
      font-size: 1.4rem;
      font-family: 'Georgia', serif;
      border-left: 5px solid orange;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(255, 165, 0, 0.4);
      opacity: 1;
    }

    .cards-container {
      position: fixed;
      bottom: 5%;
      left: 3%;
      top: 20%;
      width: 70%;
      background: green;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
      display: flex;
      padding: 20px;
      gap: 20px;
      box-sizing: border-box;
      border: 12px solid #ffcc00;
      transition: none;
      opacity: 1;
      transform: translateY(0);
    }

    .card {
      display: flex;
      width: 100%;
      height: 100%;
      gap: 20px;
      align-items: center;
    }

    .card img {
      width: 35%;
      height: auto;
      max-height: 200px;
      object-fit: cover;
      border-radius: 10px;
      flex-shrink: 0;
    }

    .card-content {
      display: flex;
      flex-direction: column;
      justify-content: center;
      flex: 1;
    }

    .card-content h3 {
      margin: 0 0 10px 0;
      font-size: 2.3rem;
      color: white;
    }

    .card-content p {
      margin: 0;
      font-size: 1.3rem;
      line-height: 1.4;
      color: rgb(253, 252, 250);
    }

    .nav-buttons {
      position: fixed;
      bottom: 5%;
      right: 3%;
      display: flex;
      gap: 15px;
    }

    .nav-buttons button {
      padding: 10px 18px;
      background: orange;
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 1rem;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      transition: background 0.3s ease;
      user-select: none;
    }

    .nav-buttons button:hover {
      background: darkorange;
    }

    /* Animation classes */
    .slide-down-fade-out {
      animation: slideDownFadeOut 0.5s forwards ease-in;
    }

    .slide-up-fade-in {
      animation: slideUpFadeIn 0.5s forwards ease-out;
    }
  </style>
</head>
<body>

  <!-- Lesson heading -->
  <div class="lesson-heading">introduction </div>

  <!-- Cards container with yellow border -->
  <div class="cards-container" id="cards-container">
  </div>

  <!-- Navigation buttons -->
  <div class="nav-buttons">
    <button id="prev-btn">Previous</button>
    <button id="next-btn">Next</button>
  </div>

<script>
  const container = document.getElementById('cards-container');
  const prevBtn = document.getElementById('prev-btn');
  const nextBtn = document.getElementById('next-btn');

  let cards = [];
  let currentIndex = 0;

  // Fetch data from backend API
  async function fetchCards() {
    try {
      const response = await fetch("/get_content", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ 'lsn': 'lsn1', 'cp': 'cp1' })
        });
      if (!response.ok) throw new Error('Failed to fetch cards');
      cards = await response.json();
      renderCard(currentIndex);
    } catch (err) {
      console.error('Error loading cards:', err);
      container.innerHTML = '<p style="color:white">Failed to load content</p>';
    }
  }

  // Render a single card by index
  function renderCard(index) {
    const card = cards[index];
    if (!card) return;

    container.innerHTML = `
      <div class="card">
        <img src="data:image/jpeg;base64,${card.image_base64}" alt="${card.heading}" />
        <div class="card-content">
          <h3>${card.heading}</h3>
          <p>${card.info}</p>
        </div>
      </div>
    `;
  }

  // Animate and navigate to another card
  function navigate(direction) {
    if ((direction === 'next' && currentIndex >= cards.length - 1) ||
        (direction === 'prev' && currentIndex <= 0)) return;

    container.classList.add('slide-down-fade-out');

    container.addEventListener('animationend', function handler() {
      container.classList.remove('slide-down-fade-out');

      // Change card index
      currentIndex += direction === 'next' ? 1 : -1;
      renderCard(currentIndex);

      container.classList.add('slide-up-fade-in');
      container.removeEventListener('animationend', handler);

      container.addEventListener('animationend', function handler2() {
        container.classList.remove('slide-up-fade-in');
        container.removeEventListener('animationend', handler2);
      });
    });
  }

  prevBtn.addEventListener('click', () => navigate('prev'));
  nextBtn.addEventListener('click', () => navigate('next'));

  // Initialize on page load
  fetchCards();
</script>

</body>
</html>
